<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>📑 Linux Sheets</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">📑 Linux Sheets</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/TrifanBogdan24/Linux-TLDR.git" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ip"><a class="header" href="#ip">IP</a></h1>
<h2 id="tldr"><a class="header" href="#tldr"><strong>TL;DR</strong></a></h2>
<hr />
<p>Show/manipulate routing, devices, policy routing and tunnels.</p>
<p>Some subcommands such as address have their own usage documentation.</p>
<p>More information: <a href="https://www.manned.org/ip.8">https://www.manned.org/ip.8</a>.</p>
<pre><code class="language-sh"># List interfaces with detailed info:
ip address

# List interfaces with brief network layer info:
ip -brief address

# List interfaces with brief link layer info:
ip -brief link

# Display the routing table:
ip route

# Show neighbors (ARP table):
ip neighbour

# Make an interface up/down:
ip link set interface up|down

# Add/Delete an IP address to an interface:
ip addr add/del ip/mask dev interface

# Add a default route:
ip route add default via ip dev interface
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ip-sub-commands"><a class="header" href="#ip-sub-commands">IP sub commands</a></h1>
<p>Sub commands:</p>
<ul>
<li><a href="content/Linux-Networking/IP/./sub-commands/ip-link.html">ip link</a></li>
<li><a href="content/Linux-Networking/IP/./sub-commands/ip-neighbour.html">ip neighbour</a></li>
<li><a href="content/Linux-Networking/IP/./sub-commands/ip-address.html">ip address</a></li>
<li><a href="content/Linux-Networking/IP/./sub-commands/ip-route.html">ip route</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ip-link"><a class="header" href="#ip-link"><code>ip link</code></a></h1>
<h2 id="tldr-1"><a class="header" href="#tldr-1"><strong>TL;DR</strong></a></h2>
<hr />
<p>Manage network interfaces.</p>
<p>More information: <a href="https://manned.org/ip-link">https://manned.org/ip-link</a>.</p>
<pre><code class="language-sh"># Show information about all network interfaces:
ip link

# Show information about a specific network interface:
ip link show &lt;ethN&gt;

# Bring a network interface up or down:
ip link set &lt;ethN&gt; &lt;up|down&gt;

# Give a meaningful name to a network interface:
ip link set &lt;ethN&gt; alias "LAN Interface"

# Change the MAC address of a network interface:
ip link set &lt;ethN&gt; address ff:ff:ff:ff:ff:ff

# Change the MTU size for a network interface to use jumbo frames:
ip link set &lt;ethN&gt; mtu 9000
</code></pre>
<h2 id="long-and-short-version"><a class="header" href="#long-and-short-version">Long and short version</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Long version</th><th style="text-align: left">Short Version</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>ip link</code></td><td style="text-align: left"><code>ip l</code> or <code>ip li</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ip-neigbour"><a class="header" href="#ip-neigbour"><code>ip neigbour</code></a></h1>
<h2 id="tldr-2"><a class="header" href="#tldr-2"><strong>TL;DR</strong></a></h2>
<hr />
<p>Neighbour/ARP tables management IP subcommand.</p>
<p>More information: <a href="https://manned.org/ip-neighbour.8">https://manned.org/ip-neighbour.8</a>.</p>
<pre><code class="language-sh"># Display the neighbour/ARP table entries:
ip neighbour

# Remove entries in the neighbour table on device eth0:
sudo ip neighbour flush dev &lt;eth0&gt;

# Perform a neighbour lookup and return a neighbour entry:
ip neighbour get lookup_ip dev &lt;eth0&gt;

# Add or delete an ARP entry for the neighbour IP address to eth0:
sudo ip neighbour &lt;add|del&gt; &lt;ip_address&gt; lladdr &lt;mac_address&gt; dev &lt;eth0&gt; nud reachable

# Change or replace an ARP entry for the neighbour IP address to eth0:
sudo ip neighbour &lt;change|replace&gt; &lt;ip_address&gt; lladdr &lt;new_mac_address&gt; dev eth0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ip-address"><a class="header" href="#ip-address"><code>ip address</code></a></h1>
<h2 id="tldr-3"><a class="header" href="#tldr-3"><strong>TL;DR</strong></a></h2>
<hr />
<p>IP Address management subcommand.</p>
<p>More information: <a href="https://manned.org/ip-address">https://manned.org/ip-address</a>.</p>
<pre><code class="language-sh"># List network interfaces and their associated IP addresses:
ip address

# Filter to show only active network interfaces:
ip address show up

# Display information about a specific network interface:
ip address show dev &lt;eth0&gt;

# Add an IP address to a network interface:
ip address add &lt;IP&gt; dev &lt;eth0&gt;

# Remove an IP address from a network interface:
ip address delete &lt;IP&gt; dev &lt;eth0&gt;

# Delete all IP addresses in a given scope from a network interface:
ip address flush dev &lt;eth0&gt; scope &lt;global|host|link&gt;
</code></pre>
<h2 id="long-and-short-versions"><a class="header" href="#long-and-short-versions">Long and short versions</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Long Version</th><th style="text-align: left">Short Version</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>ip address</code></td><td style="text-align: left"><code>ip addr</code> or <code>ip a</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ip-route"><a class="header" href="#ip-route"><code>ip route</code></a></h1>
<h2 id="tldr-4"><a class="header" href="#tldr-4"><strong>TL;DR</strong></a></h2>
<hr />
<p>IP Routing table management subcommand.</p>
<p>More information: <a href="https://manned.org/ip-route">https://manned.org/ip-route</a>.</p>
<pre><code class="language-sh"># Display the routing table:
ip route show|list

# Add a default route using gateway forwarding:
sudo ip route add default via &lt;gateway_ip&gt;

# Add a default route using eth0:
sudo ip route add default dev &lt;eth0&gt;

# Add a static route:
sudo ip route add &lt;destination_ip&gt; via &lt;gateway_ip&gt; dev &lt;eth0&gt;

# Delete a static route:
sudo ip route del &lt;destination_ip&gt; dev &lt;eth0&gt;

# Change or replace a static route:
sudo ip route &lt;change|replace destination_ip&gt; via &lt;gateway_ip&gt; dev &lt;eth0&gt;

# Show which route will be used by the kernel to reach an IP address:
ip route get &lt;destination_ip&gt;
</code></pre>
<h2 id="long-and-short-version-1"><a class="header" href="#long-and-short-version-1">Long and short version</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Long version</th><th style="text-align: left">Short version</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>ip route</code></td><td style="text-align: left"><code>ip r</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="use-of-ip"><a class="header" href="#use-of-ip">Use of IP</a></h1>
<ul>
<li><a href="content/Linux-Networking/IP/./use-of-ip/RoaS.html">RoaS</a></li>
<li><a href="content/Linux-Networking/IP/./use-of-ip/GRE.html">GRE</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roas-router-on-a-stick"><a class="header" href="#roas-router-on-a-stick"><strong>RoaS</strong> (Router on a Stick)</a></h1>
<img src="content/Linux-Networking/IP/use-of-ip/Images/RoaS-1.png" width=100%>
<img src="content/Linux-Networking/IP/use-of-ip/Images/RoaS-2.png" width=100%>
<p>The link between a <strong>switch</strong> and a  <strong>router</strong> can be configured as it follows:</p>
<ul>
<li><strong>Switch</strong>: the interface will be <strong>trunk</strong></li>
<li><strong>Router</strong>: the physical interfaces will be split into multiple <strong>logical sub-interfaces</strong>, one for each VLAN</li>
</ul>
<p><strong>RoaS</strong> allows inter-VLAN routing.
The router configured as <strong>RoaS</strong> will be able to modify the VLAN tag in the packet and
will be able to FORWARD packets from one VLAN to another (in the same LAN).</p>
<p>Steps:</p>
<ol>
<li>Create VLAN sub-interfaces</li>
<li>Assign IP addresses</li>
<li>Bring interfaces UP</li>
</ol>
<p>Example of <strong>RoaS</strong> configuration on Linux:</p>
<pre><code class="language-sh"># Split (fa01) interface in 3 (logical) sub-interfaces for VLAN 10, VLAN 20 and VLAN 30
$ up ip link add link fa01 name fa01.10 type vlan id 10
$ up ip link add link fa01 name fa01.20 type vlan id 20
$ up ip link add link fa01 name fa01.30 type vlan id 30


# Assign IPv4 addresses on sub-interfaces
$ up ip addr add 10.179.7.1/26 dev fa01.10
$ up ip addr add 10.179.7.65/26 dev fa01.20
$ up ip addr add 10.179.7.129/26 dev fa01.30

# Bring interfaces UP
$ up ip link set fa01.10 up
$ up ip link set fa01.20 up
$ up ip link set fa01.30 up
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gre-generic-routing-encapsulation"><a class="header" href="#gre-generic-routing-encapsulation"><code>GRE</code> (Generic Routing Encapsulation)</a></h1>
<blockquote>
<p>Read more here:</p>
<ul>
<li><a href="https://community.hetzner.com/tutorials/linux-setup-gre-tunnel">https://community.hetzner.com/tutorials/linux-setup-gre-tunnel</a></li>
<li><a href="https://bitlaunch.io/blog/what-is-a-gre-tunnel-and-how-to-set-one-up/">https://bitlaunch.io/blog/what-is-a-gre-tunnel-and-how-to-set-one-up/</a></li>
<li><a href="https://docs.nvidia.com/networking-ethernet-software/cumulus-linux-51/Layer-3/GRE-Tunneling/">https://docs.nvidia.com/networking-ethernet-software/cumulus-linux-51/Layer-3/GRE-Tunneling/</a></li>
</ul>
</blockquote>
<h2 id="steps"><a class="header" href="#steps">Steps</a></h2>
<hr />
<ol>
<li>Load the GRE module (if not already loaded)</li>
</ol>
<pre><code class="language-sh">sudo modprobe ip_gre
</code></pre>
<ol start="2">
<li>Create the GRE tunnel interface</li>
</ol>
<pre><code class="language-sh">sudo ip link add gre1 type gretap local &lt;LOCAL_IP&gt; remote &lt;REMOTE_IP&gt;
</code></pre>
<ul>
<li>For a pure <strong>IP over GRE</strong> (without Ethernet header, use):</li>
</ul>
<pre><code class="language-sh">sudo ip tunnel add gre1 mode gre local &lt;LOCAL_IP&gt; remote &lt;REMOTE_IP&gt; ttl 255
</code></pre>
<ol start="3">
<li>Assign an IP address on the GRE interface</li>
</ol>
<pre><code class="language-sh">sudo ip addr add &lt;TUNNEL_IP&gt;/&lt;mask&gt; dev gre1
</code></pre>
<ol start="4">
<li>Bring UP the GRE interface</li>
</ol>
<pre><code class="language-sh">sudo ip link set gre1 up
</code></pre>
<ol start="5">
<li>Add a route (if needed)</li>
</ol>
<pre><code class="language-sh">sudo ip route add &lt;DEST_NETWORK&gt; via &lt;TUNNEL_IP&gt; dev gre1
</code></pre>
<h2 id="scripts"><a class="header" href="#scripts">Scripts</a></h2>
<hr />
<p>On server 1:</p>
<pre><code class="language-sh">sudo ip tunnel add gre1 mode gre local 198.51.100.1 remote 203.0.113.1 ttl 255
sudo ip addr add 10.0.0.1/30 dev gre1
sudo ip link set gre1 up
</code></pre>
<p>On server 2:</p>
<pre><code class="language-sh">sudo ip tunnel add gre1 mode gre local 203.0.113.1 remote 198.51.100.1 ttl 255
sudo ip addr add 10.0.0.2/30 dev gre1
sudo ip link set gre1 up
</code></pre>
<blockquote>
<p>The code is from <a href="https://community.hetzner.com/tutorials/linux-setup-gre-tunnel">here</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wg-wiregurad"><a class="header" href="#wg-wiregurad"><code>wg</code> (WireGurad)</a></h1>
<p><a href="https://www.wireguard.com/"><img src="https://upload.wikimedia.org/wikipedia/commons/9/98/Logo_of_WireGuard.svg" alt="img" /></a></p>
<p>You can find all information here: <a href="https://www.wireguard.com/">https://www.wireguard.com/</a>.</p>
<h2 id="tldr-5"><a class="header" href="#tldr-5"><strong>TL;DR</strong></a></h2>
<hr />
<p>Manage the configuration of WireGuard interfaces.</p>
<p>More information: <a href="https://www.wireguard.com/quickstart/">https://www.wireguard.com/quickstart/</a>.</p>
<pre><code class="language-sh"># Check status of currently active interfaces
sudo wg

# Generate a new private key
wg genkey

# Generate a public key from a private key
wg pubkey &lt; path/to/private_key &gt; path/to/public_key

# Generate a public and private key
wg genkey | tee path/to/private_key | wg pubkey &gt; path/to/public_key

# Show the current configuration of a wireguard interface
sudo wg showconf wg0
</code></pre>
<h2 id="key-pair-creation"><a class="header" href="#key-pair-creation">Key Pair Creation</a></h2>
<hr />
<pre><code class="language-sh">wg genkey | tee /path/to/wg-priv.key | wg pubkey | tee /path/to/wg-pub.key
# or
wg genkey | tee /path/to/privatekey | wg pubkey &gt; /path/to/publickey
# or
wg genkey &gt; /path/privatekey &amp;&amp; wg pubkey &lt; /path/privatekey &gt; /path/publickey
</code></pre>
<h2 id="configuration-file-examples"><a class="header" href="#configuration-file-examples">Configuration file examples</a></h2>
<hr />
<p>WireGuard encapuslates and encrypts all data using <strong>UDP</strong> with default <strong>port 51820</strong>.</p>
<pre><code class="language-sh">nano -l /etc/interfaces/&lt;wg-interface-name&gt;.conf
</code></pre>
<h3 id="pattern"><a class="header" href="#pattern">Pattern</a></h3>
<hr />
<pre><code class="language-conf">[Interface]
Address = &lt;IP&gt;/&lt;mask&gt;
PrivateKey = &lt;your-public-key&gt;
ListenPort = 55820

[Peer]
PublicKey = &lt;public key of the other end of the tunnel&gt;
Endpoint = &lt;IP&gt;:55820
AllowedIPs = &lt;tunnel-subnet&gt;/&lt;mask&gt;
</code></pre>
<h3 id="wireguard-end-to-end-tunnel"><a class="header" href="#wireguard-end-to-end-tunnel">WireGuard <strong>End-to-End</strong> Tunnel</a></h3>
<hr />
<p>On <strong>Client1</strong>:</p>
<pre><code class="language-conf">[Interface]
Address = 10.27.214.98/30
SaveConfig = true
ListenPort = 51820
PrivateKey = cMxJNvd5rErTXyecAg4rlCmRKHohyaaz6KzYBF/qVG8=

# Client-2/wg-intf
[Peer]
PublicKey = 8Tsqi0T1DWijG7Zb0QfnWH7zcA7NnlUsGRuaUzqzR2Q=
# AllowedIPs = &lt;tunnel-subnet&gt;/&lt;mask&gt;
AllowedIPs = 10.27.214.96/30
# Endpoint = Client-2 public IP
Endpoint = 10.179.7.66:51820
PersistentKeepalive = 60
</code></pre>
<p>On <strong>Client2</strong>:</p>
<pre><code class="language-conf">[Interface]
Address = 10.27.214.97/30
SaveConfig = true
ListenPort = 51820
PrivateKey = SKff+08t1TVayJj3Ob2lemtSG0G9fXqGCvyUPYDFCUc=

# Client-1/wg-intf
[Peer]
PublicKey = ki3M91uPAU/ooKr9dogvEq7R0vHS0gQNkx83MQp7Xyo=
# AllowedIPs = &lt;tunnel-subnet&gt;/&lt;mask&gt;
AllowedIPs = 10.27.214.96/30
# Endpoint = Client-1 public IP
Endpoint = 172.30.106.246:51820
PersistentKeepalive = 60
</code></pre>
<h3 id="wireguard-server-clients-tunnel"><a class="header" href="#wireguard-server-clients-tunnel">WireGuard <strong>Server-Clients</strong> Tunnel</a></h3>
<hr />
<p>For example, a <strong>server</strong> computer might have this configuration:</p>
<pre><code class="language-sh">Interface]
PrivateKey = yAnz5TF+lXXJte14tji3zlMNq+hd2rYUIgJBgB3fBmk=
ListenPort = 51820

[Peer]
PublicKey = xTIBA5rboUvnH4htodjb6e697QjLERt1NAB4mZqp8Dg=
AllowedIPs = 10.192.122.3/32, 10.192.124.1/24

[Peer]
PublicKey = TrMvSoP4jYQlY6RIzBgbssQqY3vxI2Pi+y71lOWWXX0=
AllowedIPs = 10.192.122.4/32, 192.168.0.0/16

[Peer]
PublicKey = gN65BkIKy1eCE9pP1wdc8ROUtkHLF2PfAqYdyYBz6EA=
AllowedIPs = 10.10.10.230/32
</code></pre>
<p>And a <strong>client</strong> computer might have this simpler configuration:</p>
<pre><code class="language-sh">[Interface]
PrivateKey = gI6EdUSYvn8ugXOt8QQD6Yc+JyiZxIhp3GInSWRfWGE=
ListenPort = 21841

[Peer]
PublicKey = HIgo9xNzJMWLKASShiTqIybxZ0U3wGLiUeJ1PKf8ykw=
Endpoint = 192.95.5.69:51820
AllowedIPs = 0.0.0.0/0
</code></pre>
<h2 id="creating-the-wireguard-interfaces"><a class="header" href="#creating-the-wireguard-interfaces">Creating the WireGuard interfaces</a></h2>
<hr />
<h3 id="the-iproute2-way"><a class="header" href="#the-iproute2-way">The <code>iproute2</code> way</a></h3>
<hr />
<pre><code class="language-sh">ip link add wg-isc type wireguard
wg setconf wg-isc /etc/wireguard/wg-isc.conf  # or whatever you named your config
ip address add &lt;IP&gt;/&lt;mask&gt; dev wg-isc
</code></pre>
<h3 id="using-wg-quick"><a class="header" href="#using-wg-quick">Using <code>wg-quick</code></a></h3>
<hr />
<blockquote>
<p>The WireGuard interface name must match the name of the file <strong>/etc/wireguard/&lt;wg-interface&gt;.conf</strong>.</p>
</blockquote>
<pre><code class="language-sh">wg-quick up &lt;wg-interface&gt;
wg-quick down &lt;wg-interface&gt;
</code></pre>
<p><strong>wg-quick</strong> will automatically run the <strong>ip</strong> commands, as shown bellow:</p>
<pre><code class="language-sh">$ wg-quick up wg-isc  
[#] ip link add wg-isc type wireguard
[#] wg setconf wg-isc /dev/fd/63
[#] ip -4 address add 10.12.34.253/30 dev wg-isc
[#] ip link set mtu 1370 up dev wg-isc
</code></pre>
<pre><code class="language-sh">$ wg-quick down wg-isc                        
[#] ip link delete dev wg-isc
</code></pre>
<h2 id="wireguard-statistics"><a class="header" href="#wireguard-statistics">WireGuard statistics</a></h2>
<hr />
<pre><code class="language-sh">wg
</code></pre>
<p>Result:</p>
<img src="https://www.wireguard.com/img/wg-tool.png">
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-secure-shell"><a class="header" href="#ssh-secure-shell">SSH (Secure Shell)</a></h1>
<ul>
<li><a href="content/Linux-Networking/./SSH/ssh-keygen.html">ssh-keygen</a></li>
<li><a href="content/Linux-Networking/./SSH/ssh-copy-id.html">ssh-copy-id</a></li>
<li><a href="content/Linux-Networking/./SSH/ssh-config.html">~/.ssh/config file</a></li>
<li><a href="content/Linux-Networking/./SSH/ssh.html">ssh</a></li>
<li><a href="content/Linux-Networking/./SSH/scp.html">scp</a></li>
<li><a href="content/Linux-Networking/./SSH/ssh-github.html">SSH for GitHub</a></li>
<li><a href="content/Linux-Networking/SSH/PortFowarding/reverse-ssh.html">Reverse SSH</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-keygen"><a class="header" href="#ssh-keygen"><code>ssh-keygen</code></a></h1>
<h2 id="tldr-6"><a class="header" href="#tldr-6"><strong>TL;DR</strong></a></h2>
<hr />
<p>Generate SSH keys used for authentication, password-less logins, and other things.</p>
<p>More information: <a href="https://man.openbsd.org/ssh-keygen">https://man.openbsd.org/ssh-keygen</a>.</p>
<pre><code class="language-sh"># Generate a key interactively:
ssh-keygen

# Generate an ed25519 key with 32 key derivation function rounds and save the key to a specific file:
ssh-keygen -t ed25519 -a 32 -f ~/.ssh/filename

# Generate an RSA 4096-bit key with email as a comment:
ssh-keygen -t rsa -b 4096 -C "comment|email"

# Remove the keys of a host from the known_hosts file (useful when a known host has a new key):
ssh-keygen -R remote_host

# Retrieve the fingerprint of a key in MD5 Hex:
ssh-keygen -l -E md5 -f ~/.ssh/filename

# Change the password of a key:
ssh-keygen -p -f ~/.ssh/filename

# Change the type of the key format (for example from OPENSSH format to PEM), the file will be rewritten in-place:
ssh-keygen -p -N "" -m PEM -f ~/.ssh/OpenSSH_private_key

# Retrieve public key from secret key:
ssh-keygen -y -f ~/.ssh/OpenSSH_private_key
</code></pre>
<h2 id="all-in-one-go"><a class="header" href="#all-in-one-go">All in one go</a></h2>
<hr />
<p>Generating a <strong>SSH key pair</strong> programatically, without asking anything from the <strong>stdin</strong>.</p>
<pre><code class="language-sh">ssh-keygen -t ed25519 -f  -N "" ~/.ssh/path
</code></pre>
<p>...Or, using RSA:</p>
<pre><code class="language-sh">ssh-keygen -t rsa -b 4096 -f  -N "" ~/.ssh/path
</code></pre>
<blockquote>
<p><strong>-N</strong> option is used to specify a <strong>passphrase</strong> (a <em>password</em>). It adds more security.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-copy-id"><a class="header" href="#ssh-copy-id"><code>ssh-copy-id</code></a></h1>
<p>Is used to copy a <strong>SSH public key</strong> in the <code>~/.ssh/authorized_keys</code> file of a remote computer (creating the file and directory, if necesary).</p>
<blockquote>
<p>⚠️ DON'T copy the <strong>private key</strong>!</p>
</blockquote>
<h2 id="tldr-7"><a class="header" href="#tldr-7"><strong>TL;DR</strong></a></h2>
<hr />
<p>Install your public key in a remote machine's authorized_keys.</p>
<p>More information: <a href="https://manned.org/ssh-copy-id">https://manned.org/ssh-copy-id</a>.</p>
<pre><code class="language-sh"># Copy your keys to the remote machine:
ssh-copy-id username@remote_host

# Copy the given public key to the remote:
ssh-copy-id -i path/to/certificate username@remote_host

# Copy the given public key to the remote with specific port:
ssh-copy-id -i path/to/certificate -p port username@remote_host
</code></pre>
<pre><code class="language-sh">ssh-copy-id -i &lt;PUB_KEY&gt; &lt;user&gt;@&lt;IP/hostname&gt;
</code></pre>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<hr />
<p>In case <code>ssh-copy-id</code> fails, you have to manually copy the <strong>public key</strong>
on the <code>/home/&lt;USER&gt;/authorized_keys</code> file of the remote computer.</p>
<pre><code class="language-sh">nano -l ~/.ssh/authorized_keys
</code></pre>
<h2 id="default-keys-for-ssh"><a class="header" href="#default-keys-for-ssh">Default keys for SSH</a></h2>
<hr />
<p>When no key is specified with the <code>-i</code> flag,
<code>ssh-copy-id</code> copies the default public key from the user's SSH directory.
It follows this priority order:</p>
<ol>
<li><strong>~/.ssh/id_rsa.pub</strong> (if exists)</li>
<li><strong>~/.ssh/id_ecdsa.pub</strong> (if exists)</li>
<li><strong>~/.ssh/id_ed25519.pub</strong> (if exists)</li>
<li><strong>~/.ssh/id_dsa.pub</strong> (if exists) – deprecated and less secure</li>
<li>Any other <strong>id_*.pub</strong> key found in <strong>~/.ssh/</strong></li>
</ol>
<blockquote>
<p>If no public key is found, <code>ssh-copy-id</code> will prompt you to generate one using <code>ssh-keygen</code>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-config-file"><a class="header" href="#ssh-config-file">SSH config file</a></h1>
<p>Find more here <a href="https://collectiveidea.com/blog/archives/2011/02/04/how-to-ssh-aliases/">https://collectiveidea.com/blog/archives/2011/02/04/how-to-ssh-aliases/</a>.</p>
<pre><code class="language-sh">nano -l ~/.ssh/config
</code></pre>
<p>This <strong>configuration file</strong> is used to create <strong>SSH aliases</strong>.</p>
<pre><code class="language-config">Host example
  HostName example.com
  User exampleuser
</code></pre>
<p>Using the alias:</p>
<pre><code class="language-sh">ssh example
</code></pre>
<p>Do you have a multi-server infrastructure that you log into consistently?</p>
<pre><code class="language-config">Host project.web1
  HostName web1.project.com
  User webadmin

Host project.web2
  HostName web2.project.com
  User webadmin

Host project.db1
  HostName db1.project.com
  User webadmin

Host project.util1
  HostName util1.project.com
  User webadmin

Host project.stage
  HostName stage.project.com
  User webadmin
</code></pre>
<pre><code class="language-sh">ssh project.web1
ssh project.db1
....


# you always have the option of overriding at the command line.
ssh [email protected]
</code></pre>
<p>You can also specify the host by IP directly:</p>
<pre><code class="language-config">Host example
  HostName 127.0.0.1
  User exampleuser
</code></pre>
<p>And you can use different SSH keys:</p>
<pre><code class="language-config">Host example2
  Hostname example.com
  User exampleuser
  IdentityFile ~/.ssh/another_ssh.identity
</code></pre>
<h2 id="my-personal-ssh-config-for-openstack"><a class="header" href="#my-personal-ssh-config-for-openstack">My Personal SSH Config for <a href="https://cloud.grid.pub.ro/">OpenStack</a></a></h2>
<hr />
<pre><code class="language-config">Host open_stack
	User student
	HostName &lt;IP-VM&gt;
	ProxyJump &lt;moodle-username&gt;@fep.grid.pub.ro 
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-secure-shell-1"><a class="header" href="#ssh-secure-shell-1"><code>ssh</code> (Secure Shell)</a></h1>
<h2 id="tldr-8"><a class="header" href="#tldr-8"><strong>TL;DR</strong></a></h2>
<hr />
<p>Secure Shell is a protocol used to securely log onto remote systems.</p>
<p>It can be used for logging or executing commands on a remote server.</p>
<p>More information: <a href="https://man.openbsd.org/ssh">https://man.openbsd.org/ssh</a>.</p>
<pre><code class="language-sh"># Connect to a remote server:
ssh username@remote_host

# Connect to a remote server with a specific identity (private key):
ssh -i path/to/key_file username@remote_host

# Connect to a remote server using a specific [p]ort:
ssh username@remote_host -p 2222

# Run a command on a remote server with a [t]ty allocation allowing interaction with the remote command:
ssh username@remote_host -t command command_arguments

# SSH tunneling: [D]ynamic port forwarding (SOCKS proxy on localhost:1080):
ssh -D 1080 username@remote_host

# SSH tunneling: Forward a specific port (localhost:9999 to example.org:80) along with disabling pseudo-[T]ty allocation and executio[N] of remote commands:
ssh -L 9999:example.org:80 -N -T username@remote_host

# SSH [J]umping: Connect through a jumphost to a remote server (Multiple jump hops may be specified separated by comma characters):
ssh -J username@jump_host username@remote_host

# Close a hanged session:
&lt;Enter&gt; ~ .
</code></pre>
<h2 id="ssh-for-openstack"><a class="header" href="#ssh-for-openstack">SSH for <a href="https://cloud.grid.pub.ro/">OpenStack</a></a></h2>
<hr />
<pre><code class="language-sh">ssh -J &lt;moodle-username&gt;@fep.grid.pub.ro student@&lt;IP-VM&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scp-secure-copy"><a class="header" href="#scp-secure-copy"><code>scp</code> (Secure Copy)</a></h1>
<h2 id="tldr-9"><a class="header" href="#tldr-9"><strong>TL;DR</strong></a></h2>
<hr />
<pre><code class="language-sh"># Copy a local file to a remote host:
scp path/to/local_file remote_host:path/to/remote_file

# Use a specific port when connecting to the remote host:
scp -P port path/to/local_file remote_host:path/to/remote_file

# Copy a file from a remote host to a local directory:
scp remote_host:path/to/remote_file path/to/local_directory

# Recursively copy the contents of a directory from a remote host to a local directory:
scp -r remote_host:path/to/remote_directory path/to/local_directory

# Copy a file between two remote hosts transferring through the local host:
scp -3 host1:path/to/remote_file host2:path/to/remote_directory

# Use a specific username when connecting to the remote host:
scp path/to/local_file remote_username@remote_host:path/to/remote_directory

# Use a specific SSH private key for authentication with the remote host:
scp -i ~/.ssh/private_key path/to/local_file remote_host:path/to/remote_file

# Use a specific proxy when connecting to the remote host:
scp -J proxy_username@proxy_host path/to/local_file remote_host:path/to/remote_file
</code></pre>
<h2 id="options"><a class="header" href="#options">Options</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Option</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>scp -r</code></td><td style="text-align: left">Recursively copy entire directories</td></tr>
<tr><td style="text-align: left"><code>scp -C</code></td><td style="text-align: left">Compresses data</td></tr>
<tr><td style="text-align: left"><code>scp -v</code></td><td style="text-align: left">Prints verbose info</td></tr>
<tr><td style="text-align: left"><code>scp -P 8080</code></td><td style="text-align: left">Uses a specific Port</td></tr>
<tr><td style="text-align: left"><code>scp -B</code></td><td style="text-align: left">Batch mode (<em>Prevents password</em>)</td></tr>
<tr><td style="text-align: left"><code>scp -p</code></td><td style="text-align: left">Preserves times and modes</td></tr>
</tbody></table>
</div>
<h2 id="ssh-for-openstack-1"><a class="header" href="#ssh-for-openstack-1">SSH for <a href="https://cloud.grid.pub.ro/">OpenStack</a></a></h2>
<hr />
<p><strong>Upload</strong> a file on OpenStack:</p>
<pre><code class="language-sh">scp -J &lt;moodle-username&gt;@fep.grid.pub.ro &lt;PATH_LOCAL_FILE&gt; student@&lt;IP-VM&gt;:&lt;PATH_REMOTE_DIR&gt;
</code></pre>
<p><strong>Download</strong> a file from OpenStack:</p>
<pre><code class="language-sh">scp -J &lt;moodle-username&gt;@fep.grid.pub.ro student@&lt;IP-VM&gt;:&lt;PATH_REMOTE_FILE&gt; &lt;PATH_LOCAL_FILE&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-for-github"><a class="header" href="#ssh-for-github"><code>SSH</code> for GitHub</a></h1>
<iframe width="500" height="300" src="https://www.youtube.com/embed/X40b9x9BFGo" title="🐱Generate a New SSH Key and Add it to your GitHub" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<h2 id="push-and-clone-using-ssh-instead-of-https"><a class="header" href="#push-and-clone-using-ssh-instead-of-https">Push and Clone using SSH (instead of HTTPS)</a></h2>
<hr />
<p>Generate a SSH key pair:</p>
<pre><code class="language-sh">ssh-keygen -t ed25519 -N "" -f ~/.ssh/github
</code></pre>
<p>Copy the <strong>public key</strong>:</p>
<pre><code class="language-sh">cat ~/.ssh/github.pub
</code></pre>
<p>Add the <strong>public key</strong> in <strong>Settings -&gt; SSH and GPG keys -&gt; New SSH key</strong>.</p>
<p>Test the SSH connection</p>
<pre><code class="language-sh">ssh -i ~/.ssh/github -T git@github.com
</code></pre>
<p>When you run the command for the first time, you will see something like:</p>
<pre><code>&gt; The authenticity of host 'github.com (IP ADDRESS)' can't be established.
&gt; ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF/zLDA0zPMSvHdkr4UvCOqU.
&gt; Are you sure you want to continue connecting (yes/no)?
</code></pre>
<p>If the above command runs successfully, it will prompt:</p>
<pre><code>Hi &lt;UserName&gt;! You've successfully authenticated, but GitHub does not provide shell access.
</code></pre>
<p>SSH config entry for GitHub:</p>
<pre><code class="language-sh">nano -l ~/.ssh/config
</code></pre>
<pre><code class="language-config">Host github.com
  HostName github.com
  User git
  IdentityFile ~/.ssh/github
  IdentitiesOnly yes
</code></pre>
<h2 id="replacing-remote-origin-to-use-ssh-insteado-of-https"><a class="header" href="#replacing-remote-origin-to-use-ssh-insteado-of-https">Replacing remote origin to use SSH (insteado of HTTPS)</a></h2>
<hr />
<blockquote>
<p><strong>TL;DR</strong>: <code>git remote set-url origin git@github.com:&lt;UserName&gt;/&lt;RepoName&gt;.git</code></p>
</blockquote>
<p>If the repository currenlty uses <strong>HTTPS</strong>, don't worry, we can change that.</p>
<pre><code class="language-sh">$ git remote -v
origin  https://github.com/&lt;UserName&gt;/&lt;RepoName&gt;.git (fetch)
origin  https://github.com/&lt;UserName&gt;/&lt;RepoName&gt;.git (push
</code></pre>
<pre><code class="language-sh">git remote set-url origin git@github.com:&lt;UserName&gt;/&lt;RepoName&gt;.git
</code></pre>
<pre><code class="language-sh">$ git remote -v
origin  git@github.com:&lt;UserName&gt;/&lt;RepoName&gt;.git (fetch)
origin  git@github.com:&lt;UserName&gt;/&lt;RepoName&gt;.git (push
</code></pre>
<blockquote>
<p>NOTE: <code>&lt;...&gt;</code> are placeholders.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="port-forwading-with-ssh"><a class="header" href="#port-forwading-with-ssh">Port Forwading with SSH</a></h1>
<blockquote>
<p>Not the one with <code>iptables</code> 🙂.</p>
</blockquote>
<p>We actually tunell the traffic from a port on a remote station to a port on the local machine (<strong>localhost</strong>),
or vice versa.</p>
<p>Types of port forwarding:</p>
<ul>
<li><a href="content/Linux-Networking/SSH/./PortFowarding/local-port-fowarding.html">Local Port Forwarding</a>
<ul>
<li>I want access remote resources that I can't access</li>
</ul>
</li>
<li><a href="content/Linux-Networking/SSH/./PortFowarding/remote-port-forwarding.html">Remote Port Forwarding</a> (a.k.a <strong>Reverse SSH</strong>/<strong>Reverse Port Forwading</strong>)
<ul>
<li>I want people to acccess local resources that they don't have access to</li>
<li>E.g.: local web server</li>
</ul>
</li>
</ul>
<iframe width="750" height="425" src="https://www.youtube.com/embed/N8f5zv9UUMI" title="SSH Tunneling - Local &amp; Remote Port Forwarding (by Example)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><div style="break-before: page; page-break-before: always;"></div><h1 id="local-port-forwarding"><a class="header" href="#local-port-forwarding">Local Port Forwarding</a></h1>
<blockquote>
<p>Seach for <strong><code>-L</code> flag</strong> in the SSH manual page.</p>
</blockquote>
<ul>
<li><strong>-L [bind_address:]port:host:hostport</strong></li>
<li><strong>-L [bind_address:]port:remote_socket</strong></li>
<li><strong>-L local_socket:host:hostport</strong></li>
<li><strong>-L local_socket:remote_socket</strong></li>
</ul>
<h2 id="how-to-ssh-tunnel-simple-example"><a class="header" href="#how-to-ssh-tunnel-simple-example">How to SSH Tunnel (simple example)</a></h2>
<hr />
<iframe width="750px" height="425px" src="https://www.youtube.com/embed/x1yQF1789cE" title="How to SSH Tunnel (simple example)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<h2 id="local-port-forwading-for-openstack"><a class="header" href="#local-port-forwading-for-openstack">Local Port Forwading for <a href="https://cloud.grid.pub.ro/project/">OpenStack</a></a></h2>
<hr />
<p>Let's say that I created in OpenStack a VM that hosts a website.
The problem is that the VM does not provide a graphical interface, it's just the terminal.</p>
<p>Using <strong>(local) port forwarding</strong>, I can tunnnel the traffic coming from a port on the remote VM
through a (local) port on my local machine.</p>
<p>Just run one of the below commands (they are eqivalent):</p>
<pre><code class="language-sh">ssh -J &lt;moodle-username&gt;@fep.grid.pub.ro -L localhost:&lt;port-local&gt;:&lt;IP-VM&gt;:&lt;port-VM&gt; -T -N student@&lt;IP-VM&gt; 
ssh -J &lt;moodle-username&gt;@fep.grid.pub.ro -L &lt;port-local&gt;:&lt;IP-VM&gt;:&lt;port-VM&gt; -T -N student@&lt;IP-VM&gt; 

ssh -J &lt;moodle-username&gt;@fep.grid.pub.ro -L localhost:&lt;port-local&gt;:localhost:&lt;port-VM&gt; -T -N student@&lt;IP-VM&gt; 
ssh -J &lt;moodle-username&gt;@fep.grid.pub.ro -L &lt;port-local&gt;:localhost:&lt;port-VM&gt; -T -N student@&lt;IP-VM&gt; 
</code></pre>
<blockquote>
<p>In the port-binding part, the IP of the VM can be replaced wtih <em><strong>localhost</strong></em>.</p>
</blockquote>
<p>If the process running at that port on the remote station is a website,
I can see it in my own <strong>browser</strong>, at the folloing URL: <code>http://localhost:&lt;port-local&gt;</code>
(just type <code>localhost:&lt;port-local&gt;</code> in the browser).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="remote-port-forwarding"><a class="header" href="#remote-port-forwarding">Remote Port Forwarding</a></h1>
<blockquote>
<p>a.k.a <strong>Reverse SSH</strong>/<strong>Reverse Port Forwarding</strong>.</p>
</blockquote>
<blockquote>
<p>Seach for <strong><code>-R</code> flag</strong> in the SSH manual page.</p>
</blockquote>
<ul>
<li><strong>-R [bind_address:]port:host:hostport</strong></li>
<li><strong>-R [bind_address:]port:local_socket</strong></li>
<li><strong>-R remote_socket:host:hostport</strong></li>
<li><strong>-R remote_socket:local_socket</strong></li>
<li><strong>-R [bind_address:]port</strong></li>
</ul>
<h2 id="what-is-a-reverse-tunnel"><a class="header" href="#what-is-a-reverse-tunnel">What is a Reverse Tunnel</a></h2>
<hr />
<p>TODO: corecteaza si verifica sa vezi sa fie bine</p>
<blockquote>
<p><strong>TL;DR</strong>:</p>
<ul>
<li>we act as a <strong>server</strong> instead of a client</li>
<li>we no longer connect, we <strong>serve</strong></li>
</ul>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">/</th><th style="text-align: center">Normal SSH</th><th style="text-align: center">Reverse SSH</th></tr></thead><tbody>
<tr><td style="text-align: center">Who runs the <code>ssh</code> cmd?</td><td style="text-align: center">Client</td><td style="text-align: center">Server</td></tr>
</tbody></table>
</div>
<p>When we run the following command, we become an <strong>SSH client</strong> to a specific station (server):</p>
<pre><code class="language-sh">ssh user@IP
</code></pre>
<p>However, things can happen the opposite (<strong>reversed</strong>) way: we can also act as a <strong>server</strong> to a specific client, and the command will look like this:</p>
<pre><code class="language-sh">ssh -N -R localhost:&lt;port-on-server&gt;:&lt;IP-client&gt;:&lt;port-on-client&gt; &lt;client-user&gt;@&lt;IP-client&gt;
</code></pre>
<p>Short hand version:</p>
<pre><code class="language-sh">ssh -N -R &lt;port-on-server&gt;:&lt;IP-client&gt;:&lt;port-on-client&gt; &lt;client-user&gt;@&lt;IP-client&gt;
</code></pre>
<blockquote>
<p>The command basically maps a port (<strong>port forwarding</strong>) on the (locally run) server to a port of the (remote) client.</p>
</blockquote>
<h2 id="how-to-reverse-ssh-tunnel"><a class="header" href="#how-to-reverse-ssh-tunnel">How to Reverse SSH Tunnel</a></h2>
<hr />
<iframe width="750px" height="425px" src="https://www.youtube.com/embed/TZ6W9Hi9YJw" title="How to Reverse SSH Tunnel" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<pre><code class="language-sh">ssh -N -R localhost:8888:192.168.1.6:80 root@159.223.180.93
</code></pre>
<p>The local port on 8888 will be accessible on the remote machine</p>
<pre><code class="language-sh">ssh -N -R 8888:192.168.1.6:80 root@159.223.180.93
</code></pre>
<p><img src="content/Linux-Networking/SSH/PortFowarding/../Images/Reverse-SSH-Tunnel.png" alt="img" /></p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-become-an-ssh-server"><a class="header" href="#how-to-become-an-ssh-server">How to become an SSH Server</a></h1>
<p>For becoming a <strong>SSH server</strong>, we need to have <code>openssh-server</code> CLI tool installed.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">CLI Tool</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: center"><code>openssh-server</code></td><td style="text-align: left">Is used to accept SSH connections</td></tr>
<tr><td style="text-align: center"><code>openssh-client</code></td><td style="text-align: left">Is used to make SSH connection (when running <code>ssh</code> commands)</td></tr>
</tbody></table>
</div>
<p>We can that by running the following command:</p>
<pre><code class="language-sh">dpkg -l | grep openssh-server
</code></pre>
<p><strong>If not</strong>, it can be installed by:</p>
<pre><code class="language-sh">sudo apt update &amp;&amp; sudo apt install -y openssh-server
</code></pre>
<blockquote>
<p>Use the package manager of your OS.</p>
</blockquote>
<p>It will automatically create configuration files like <code>etc/ssh/sshd_config</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-change-the-port-ssh-runs-on"><a class="header" href="#how-to-change-the-port-ssh-runs-on">How to change the port SSH runs on</a></h1>
<blockquote>
<p>By default, SSH runs on <strong>port 22</strong>, but we can change that.</p>
</blockquote>
<blockquote>
<p>Edit <code>/etc/ssh/sshd_config</code> file.</p>
</blockquote>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<hr />
<pre><code class="language-sh">$ sudo find /etc/ -name 'sshd_config'
/etc/ssh/sshd_config
</code></pre>
<p>Open that file and find the line <code>#Port 22</code>.
Then uncomment it and replace <strong>22</strong> with a new port number.</p>
<pre><code class="language-sh">nano -l /etc/ssh/sshd_config    # or vim
</code></pre>
<blockquote>
<p>Line <code>#Port 22</code> -&gt; <code>Port &lt;number&gt;</code></p>
</blockquote>
<p>Now, restart the <strong>ssh</strong> process:</p>
<p>For Debian/Ubuntu:</p>
<pre><code class="language-sh">service sshd restart    
</code></pre>
<p>You can verify that SSH runs on a different port by typing this <strong>netstat</strong> commadn:</p>
<pre><code class="language-sh">netstat -tulpan
</code></pre>
<p>Notice that the <strong>port 22</strong> is no longer opened and default SSH connections are blocked (<em>refused</em>).</p>
<p>In order to <strong>SSH</strong> into the remote station, we need to specify the <strong>selected port</strong>:</p>
<pre><code class="language-sh">ssh &lt;user&gt;@&lt;IP/hostname&gt; -p &lt;port&gt;
</code></pre>
<blockquote>
<p>Make sure that no firewall rules are applied against the <strong>selected port</strong> for <code>SSH</code>-ing into the remote station.</p>
</blockquote>
<h2 id="also-see"><a class="header" href="#also-see">Also see</a></h2>
<hr />
<iframe width="750" height="425" src="https://www.youtube.com/embed/NRH7mOVhHok" title="How to change the SSH port on Linux or Unix servers | VPS Tutorial" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<p><img src="content/Linux-Networking/SSH/SSH-Server/../Images/change-SSH-port/img-1.png" alt="img" />
<img src="content/Linux-Networking/SSH/SSH-Server/../Images/change-SSH-port/img-2.png" alt="img" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rsync"><a class="header" href="#rsync"><code>rsync</code></a></h1>
<h2 id="tldr-10"><a class="header" href="#tldr-10"><strong>TL;DR</strong></a></h2>
<hr />
<p>Transfer files either to or from a remote host (but not between two remote hosts), by default using <strong>SSH</strong>.</p>
<p>To specify a remote path, use <strong>user@host:path/to/file_or_directory</strong>.</p>
<p>More information: <a href="https://download.samba.org/pub/rsync/rsync.1">https://download.samba.org/pub/rsync/rsync.1</a>.</p>
<pre><code class="language-sh"># Transfer a file:
rsync path/to/source path/to/destination

# Use archive mode (recursively copy directories, copy symlinks without resolving, and preserve permissions, ownership and modification times):
rsync -a|--archive path/to/source path/to/destination

# Compress the data as it is sent to the destination, display verbose and human-readable progress, and keep partially transferred files if interrupted:
rsync -zvhP|--compress --verbose --human-readable --partial --progress path/to/source path/to/destination

# Recursively copy directories:
rsync -r|--recursive path/to/source path/to/destination

# Transfer directory contents, but not the directory itself:
rsync -r|--recursive path/to/source/ path/to/destination

# Use archive mode, resolve symlinks, and skip files that are newer on the destination:
rsync -auL|--archive --update --copy-links path/to/source path/to/destination

# Transfer a directory from a remote host running rsyncd and delete files on the destination that do not exist on the source:
rsync -r|--recursive --delete rsync://host:path/to/source path/to/destination

# Transfer a file over SSH using a different port than the default (22) and show global progress:
rsync -e|--rsh 'ssh -p port' --info=progress2 host:path/to/source path/to/destination
</code></pre>
<h2 id="options-1"><a class="header" href="#options-1">Options</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Option</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>-v</code></td><td style="text-align: left">Increases verbosity</td></tr>
<tr><td style="text-align: left"><code>-r</code></td><td style="text-align: left">Recursive, copies directories recursively</td></tr>
<tr><td style="text-align: left"><code>-a</code></td><td style="text-align: left">Archive mode, preserves permissions, ownerships, etc</td></tr>
<tr><td style="text-align: left"><code>-z</code></td><td style="text-align: left">Compress file data during the transfer</td></tr>
<tr><td style="text-align: left"><code>-h</code></td><td style="text-align: left">Output numbers in a human-readable format</td></tr>
<tr><td style="text-align: left"><code>--delete</code></td><td style="text-align: left">Delete extraneous (unnecessary) files from destination dirs</td></tr>
<tr><td style="text-align: left"><code>--progress</code></td><td style="text-align: left">Show progress during transfer</td></tr>
<tr><td style="text-align: left"><code>-e ssh</code></td><td style="text-align: left">Specify the ssh as remote shell</td></tr>
<tr><td style="text-align: left"><code>--exclude</code></td><td style="text-align: left">Exclude files matching a specified pattern</td></tr>
<tr><td style="text-align: left"><code>--include</code></td><td style="text-align: left">Don't exclude files matching a specified pattern</td></tr>
</tbody></table>
</div>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<hr />
<pre><code class="language-sh"># Sync files/dirs between local and remote host.
rsync -avzh source destination


# Sync files/dirs from remote host to local host.
rsync -avzhe ssh user@remote:/source /destination


# Sync files/dirs from local host to remote host.
rsync -avzhe ssh /source user@remote:/destination


# Sync with deletion where if a file/directory is removed from source,
# it will be removed from destination
rsync -avzh --delete source destination


# Sync with progress output
rsync -avzh --progress source destination


# Sync while excluding directories/files that match pattern.
rsync -avzh --exclude 'Dir*' source destination


# Sync only directories/files that match pattern.
rsync -avzh --include 'Dir*' --exclude '*' source destination
</code></pre>
<blockquote>
<p>You can use <code>--include</code> and <code>--exclude</code> options multiple times.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="netcat-aka-nc"><a class="header" href="#netcat-aka-nc"><code>netcat</code> (a.k.a <code>nc</code>)</a></h1>
<h2 id="tldr-11"><a class="header" href="#tldr-11"><strong>TL;DR</strong></a></h2>
<hr />
<p>Redirect I/O into a network stream through this versatile tool.</p>
<p>More information: <a href="https://manned.org/nc">https://manned.org/nc</a>.</p>
<pre><code class="language-sh"># Start a listener on the specified TCP port and send a file into it:
nc -l -p port &lt; filename

# Connect to a target listener on the specified port and receive a file from it:
nc host port &gt; received_filename

# Scan the open TCP ports of a specified host:
nc -v -z -w timeout_in_seconds host start_port-end_port

# Start a listener on the specified TCP port and provide your local shell access to the connected party (this is dangerous and can be abused):
nc -l -p port -e shell_executable

# Connect to a target listener and provide your local shell access to the remote party (this is dangerous and can be abused):
nc host port -e shell_executable

# Act as a proxy and forward data from a local TCP port to the given remote host:
nc -l -p local_port | nc host remote_port

# Send an HTTP GET request:
echo -e "GET / HTTP/1.1\nHost: host\n\n" | nc host 80
</code></pre>
<h2 id="file-transfer"><a class="header" href="#file-transfer">File Transfer</a></h2>
<hr />
<blockquote>
<p>Source from: <a href="https://www.youtube.com/shorts/1j17UBGqSog?feature=share">https://www.youtube.com/shorts/1j17UBGqSog?feature=share</a>.</p>
</blockquote>
<iframe width=600px height="350px" aspect-ratio=16/9 src="https://www.youtube.com/embed/1j17UBGqSog" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<p>Firstly, we need to run this on the <strong>receiver</strong>:</p>
<pre><code class="language-sh">netcat -l 1234 &gt; SECRETS.txt
</code></pre>
<p>Then the <strong>sender</strong> will type:</p>
<pre><code class="language-sh">cat SECRETS.txt | netcat &lt;IP-Receiver&gt; 1234 -q 0
</code></pre>
<p>The <strong>-q 0</strong> flag closes the connection when the transfer if complete.</p>
<p>Also, don't forget to verify the <strong>hashes</strong> of the files, using a CLI tool loke <code>sha512sum</code>.</p>
<blockquote>
<p>During a network file transfer, <code>netcat</code> doesn't perform <strong>integrity check</strong>.
There is the <em>small chance</em> that the file was not transfered correctly.
It is a good practice to calculate a <strong>checksum</strong>.</p>
</blockquote>
<pre><code class="language-sh"># Both on sender and receiver
shat512sum SECRETS.txt
</code></pre>
<h2 id="options-2"><a class="header" href="#options-2">Options</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Flag</th><th style="text-align: left">Example Command</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>-h</code></td><td style="text-align: left"><code>nc -h</code></td><td style="text-align: left">Help</td></tr>
<tr><td style="text-align: left"><code>-z</code></td><td style="text-align: left"><code>nc -z 192.168.1.9 1-100</code></td><td style="text-align: left">Port scan for a host or IP address</td></tr>
<tr><td style="text-align: left"><code>-v</code></td><td style="text-align: left"><code>nc -zv 192.168.1.9 1-100</code></td><td style="text-align: left">Provide verbose output</td></tr>
<tr><td style="text-align: left"><code>-n</code></td><td style="text-align: left"><code>nc -zn 192.168.1.9 1-100</code></td><td style="text-align: left">Fast scan by disabling DNS resolution</td></tr>
<tr><td style="text-align: left"><code>-l</code></td><td style="text-align: left"><code>nc -lp 8000</code></td><td style="text-align: left">TCP Listen mode (for inbound connects)</td></tr>
<tr><td style="text-align: left"><code>-w</code></td><td style="text-align: left"><code>nc -w 180 192.168.1.9 8000</code></td><td style="text-align: left">Define timeout value</td></tr>
<tr><td style="text-align: left"><code>-k</code></td><td style="text-align: left"><code>nc -kl 8000</code></td><td style="text-align: left">Continue listening after disconnection</td></tr>
<tr><td style="text-align: left"><code>-u</code></td><td style="text-align: left"><code>nc -u 192.168.1.9 8000</code></td><td style="text-align: left">Use UDP instead of TCP</td></tr>
<tr><td style="text-align: left"><code>-q</code></td><td style="text-align: left"><code>nc -q 1 192.168.1.9 8000</code></td><td style="text-align: left">Client stay up after EOF</td></tr>
<tr><td style="text-align: left"><code>-4</code></td><td style="text-align: left"><code>nc -4 -l 8000</code></td><td style="text-align: left">IPv4 only</td></tr>
<tr><td style="text-align: left"><code>-6</code></td><td style="text-align: left"><code>nc -6 -l 8000</code></td><td style="text-align: left">IPv6 only</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="netstat"><a class="header" href="#netstat"><code>netstat</code></a></h1>
<h2 id="tldr-12"><a class="header" href="#tldr-12"><strong>TL;DR</strong></a></h2>
<hr />
<p>Display network-related information such as open connections, open socket ports, etc.
See also: ss.</p>
<p>More information: <a href="https://manned.org/netstat">https://manned.org/netstat</a>.</p>
<pre><code class="language-sh"># List all ports:
netstat --all

# List all listening ports:
netstat --listening

# List listening TCP ports:
netstat --tcp

# Display PID and program names:
netstat --program

# List information continuously:
netstat --continuous

# List routes and do not resolve IP addresses to hostnames:
netstat --route --numeric

# List listening TCP and UDP ports (+ user and process if you're root):
netstat --listening --program --numeric --tcp --udp --extend
</code></pre>
<h2 id="options-3"><a class="header" href="#options-3">Options</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">[OPTION]</th><th style="text-align: left">Command</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>-a</code></td><td style="text-align: left"><code>netstat -a</code></td><td style="text-align: left">Displays all active ports</td></tr>
<tr><td style="text-align: left"><code>-e</code></td><td style="text-align: left"><code>netstat -e</code></td><td style="text-align: left">Shows statistics about your network connection (received and sent data packets, etc.)</td></tr>
<tr><td style="text-align: left"><code>-i</code></td><td style="text-align: left"><code>netstat -i</code></td><td style="text-align: left">Brings up the netstat overview menu</td></tr>
<tr><td style="text-align: left"><code>-n</code></td><td style="text-align: left"><code>netstat -n</code></td><td style="text-align: left">Numerical display of addresses and port numbers</td></tr>
<tr><td style="text-align: left"><code>-p protocol</code></td><td style="text-align: left"><code>netstat -p TCP</code></td><td style="text-align: left">Displays the connections for the specified protocol, in this case TCP (also possible: UDP, TCPv6, or UDPv6)</td></tr>
<tr><td style="text-align: left"><code>-q</code></td><td style="text-align: left"><code>netstat -q</code></td><td style="text-align: left">Lists all connections, all listening TCP ports, and all open TCP ports that are not listening</td></tr>
<tr><td style="text-align: left"><code>-r</code></td><td style="text-align: left"><code>netstat -r</code></td><td style="text-align: left">Displays the IP routing table</td></tr>
<tr><td style="text-align: left"><code>-s</code></td><td style="text-align: left"><code>netstat -s</code></td><td style="text-align: left">Retrieves statistics about the important network protocols such as TCP, IP, or UDP</td></tr>
</tbody></table>
</div>
<h2 id="all-in-one-go-1"><a class="header" href="#all-in-one-go-1">All in one go</a></h2>
<hr />
<pre><code class="language-sh">netstat -tulpan
</code></pre>
<blockquote>
<p><code>-n</code> flag disables <strong>DNS resolution</strong>, meaning that IP addresses will be displayed instead of names and the ouput will be printed faster.</p>
</blockquote>
<pre><code class="language-sh"># With DNS resolution
netstat -tulpa
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nmap"><a class="header" href="#nmap"><code>nmap</code></a></h1>
<blockquote>
<p>⚠️ <code>nmap</code> is illegal! Don't run it on networks you don't own and you aren't authorized to scan!</p>
</blockquote>
<h2 id="tldr-13"><a class="header" href="#tldr-13"><strong>TL;DR</strong></a></h2>
<hr />
<p>Network exploration tool and security/port scanner.</p>
<p>Some features (e.g. SYN scan) activate only when nmap is run with root privileges.</p>
<p>More information: <a href="https://nmap.org/book/man.html">https://nmap.org/book/man.html</a>.</p>
<pre><code class="language-sh"># Scan the top 1000 ports of a remote host with various [v]erbosity levels:
nmap -v1|2|3 ip_or_hostname

# Run a ping sweep over an entire subnet or individual hosts very aggressively:
nmap -T5 -sn 192.168.0.0/24|ip_or_hostname1,ip_or_hostname2,...

# Enable OS detection, version detection, script scanning, and traceroute of hosts from a file:
sudo nmap -A -iL path/to/file.txt

# Scan a specific list of ports (use -p- for all ports from 1 to 65535):
nmap -p port1,port2,... ip_or_host1,ip_or_host2,...

# Perform service and version detection of the top 1000 ports using default NSE scripts, writing results (-oA) to output files:
nmap -sC -sV -oA top-1000-ports ip_or_host1,ip_or_host2,...

# Scan target(s) carefully using default and safe NSE scripts:
nmap --script "default and safe" ip_or_host1,ip_or_host2,...

# Scan for web servers running on standard ports 80 and 443 using all available http-* NSE scripts:
nmap --script "http-*" ip_or_host1,ip_or_host2,... -p 80,443

# Attempt evading IDS/IPS detection by using an extremely slow scan (-T0), decoy source addresses (-D), [f]ragmented packets, random data and other methods:
sudo nmap -T0 -D decoy_ip1,decoy_ip2,... --source-port 53 -f --data-length 16 -Pn ip_or_host
</code></pre>
<h2 id="common-used-options"><a class="header" href="#common-used-options">Common Used Options</a></h2>
<hr />
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Option</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>-sL</code></td><td style="text-align: left">List Scan - simply list targets to scan</td></tr>
<tr><td style="text-align: left"><code>-sn</code></td><td style="text-align: left">Ping Scan - disable port scan</td></tr>
<tr><td style="text-align: left"><code> -p &lt;port ranges&gt;</code></td><td style="text-align: left">Only scan specified ports</td></tr>
<tr><td style="text-align: left"><code>-sV</code></td><td style="text-align: left">Probe open ports to determine service/version info</td></tr>
<tr><td style="text-align: left"><code>-O</code></td><td style="text-align: left">Enable OS detection</td></tr>
<tr><td style="text-align: left"><code>-T&lt;0-5&gt;</code></td><td style="text-align: left">Set timing template (higher is faster)</td></tr>
<tr><td style="text-align: left"><code>-n/-R</code></td><td style="text-align: left">Never do DNS resolution/Always resolve [default: sometimes]</td></tr>
<tr><td style="text-align: left"><code>--spoof-mac &lt;mac address/prefix/vendor name&gt;</code></td><td style="text-align: left">Spoof your MAC address</td></tr>
<tr><td style="text-align: left"><code>-v</code></td><td style="text-align: left">Increase verbosity level (use <code>-vv</code> or more for greater effect)</td></tr>
<tr><td style="text-align: left"><code>-d</code></td><td style="text-align: left">Increase debugging level (use <code>-dd</code> or more for greater effect)</td></tr>
<tr><td style="text-align: left"><code>-6</code></td><td style="text-align: left">Enable IPv6 scanning</td></tr>
<tr><td style="text-align: left"><code>-A</code></td><td style="text-align: left">Enable OS detection, version detection, script scanning, and traceroute</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="awk"><a class="header" href="#awk"><code>awk</code></a></h1>
<h2 id="tldr-14"><a class="header" href="#tldr-14"><strong>TL;DR</strong></a></h2>
<hr />
<p>A versatile programming language for working on files.</p>
<p>More information: <a href="https://github.com/onetrueawk/awk">https://github.com/onetrueawk/awk</a>.</p>
<pre><code class="language-sh"># Print the fifth column (a.k.a. field) in a space-separated file:
awk '{print $5}' path/to/file

# Print the second column of the lines containing "foo" in a space-separated file:
awk '/foo/ {print $2}' path/to/file

# Print the last column of each line in a file, using a comma (instead of space) as a field separator:
awk -F ',' '{print $NF}' path/to/file

# Sum the values in the first column of a file and print the total:
awk '{s+=$1} END {print s}' path/to/file

# Print every third line starting from the first line:
awk 'NR%3==1' path/to/file

# Print different values based on conditions:
awk '{if ($1 == "foo") print "Exact match foo"; else if ($1 ~ "bar") print "Partial match bar"; else print "Baz"}' path/to/file

# Print all the lines which the 10th column value is between a min and a max:
awk '($10 &gt;= min_value &amp;&amp; $10 &lt;= max_value)'

# Print table of users with UID &gt;=1000 with header and formatted output, using colon as separator (%-20s mean: 20 left-align string characters, %6s means: 6 right-align string characters):
awk 'BEGIN {FS=":";printf "%-20s %6s %25s\n", "Name", "UID", "Shell"} $4 &gt;= 1000 {printf "%-20s %6d %25s\n", $1, $4, $7}' /etc/passwd
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grep"><a class="header" href="#grep"><code>grep</code></a></h1>
<h2 id="tldr-15"><a class="header" href="#tldr-15"><strong>TL;DR</strong></a></h2>
<hr />
<p>Find patterns in files using regular expressions.</p>
<p>More information: <a href="https://www.gnu.org/software/grep/manual/grep.html">https://www.gnu.org/software/grep/manual/grep.html</a>.</p>
<pre><code class="language-sh"># Search for a pattern within a file:
grep "search_pattern" path/to/file

# Search for an exact string (disables regular expressions):
grep -F|--fixed-strings "exact_string" path/to/file

# Search for a pattern in all files recursively in a directory, showing line numbers of matches, ignoring binary files:
grep -r|--recursive -n|--line-number --binary-files without-match "search_pattern" path/to/directory

# Use extended regular expressions (supports ?, +, {}, () and |), in case-insensitive mode:
grep -E|--extended-regexp -i|--ignore-case "search_pattern" path/to/file

# Print 3 lines of context around, before, or after each match:
grep --context|before-context|after-context 3 "search_pattern" path/to/file

# Print file name and line number for each match with color output:
grep -H|--with-filename -n|--line-number --color=always "search_pattern" path/to/file

# Search for lines matching a pattern, printing only the matched text:
grep -o|--only-matching "search_pattern" path/to/file

# Search stdin for lines that do not match a pattern:
cat path/to/file | grep -v|--invert-match "search_pattern"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sed"><a class="header" href="#sed"><code>sed</code></a></h1>
<h2 id="tldr-16"><a class="header" href="#tldr-16"><strong>TL;DR</strong></a></h2>
<hr />
<p>Edit text in a scriptable manner.
See also: awk, ed.</p>
<p>More information: <a href="https://manned.org/sed.1posix">https://manned.org/sed.1posix</a>.</p>
<pre><code class="language-sh"># Replace all apple (basic regex) occurrences with mango (basic regex) in all input lines and print the result to stdout:
command | sed 's/apple/mango/g'

# Execute a specific script [f]ile and print the result to stdout:
command | sed -f path/to/script.sed

# Print just a first line to stdout:
command | sed -n '1p'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="find"><a class="header" href="#find"><code>find</code></a></h1>
<h2 id="tldr-17"><a class="header" href="#tldr-17"><strong>TL;DR</strong></a></h2>
<hr />
<p>Find files or directories under a directory tree, recursively.</p>
<p>More information: <a href="https://manned.org/find">https://manned.org/find</a>.</p>
<pre><code class="language-sh"># Find files by extension:
find root_path -name '*.ext'

# Find files matching multiple path/name patterns:
find root_path -path '**/path/**/*.ext' -or -name '*pattern*'

- Find directories matching a given name, in case-insensitive mode:
find root_path -type d -iname '*lib*'

# Find files matching a given pattern, excluding specific paths:
find root_path -name '*.py' -not -path '*/site-packages/*'

# Find files matching a given size range, limiting the recursive depth to "1":
find root_path -maxdepth 1 -size +500k -size -10M

# Run a command for each file (use {} within the command to access the filename):
find root_path -name '*.ext' -exec wc -l {} \;

# Find all files modified today and pass the results to a single command as arguments:
find root_path -daystart -mtime -1 -exec tar -cvf archive.tar {} \+

# Find empty files (0 byte) or directories and delete them verbosely:
find root_path -type f|d -empty -delete -print
</code></pre>
<h2 id="find-all-ccpp-related-files"><a class="header" href="#find-all-ccpp-related-files">Find all C/CPP related files</a></h2>
<hr />
<p>Find all files (<strong>recursively</strong>) in the current directory  using a <strong>single extension</strong>:</p>
<pre><code class="language-sh">find . -name '*.c*'
</code></pre>
<p>Find files based of <strong>multiple extensions</strong>:</p>
<pre><code class="language-sh">find . -name '*.c*' -or -name '*.cpp' -or -name '*.h'
# or
find . \( -name '*.c*' -o -name '*.cpp' -o -name '*.h' \) 
</code></pre>
<blockquote>
<p>NOTE: <code>-o</code> flag is equivalent to <code>-or</code>.</p>
</blockquote>
<p>Because of the spaces, the following command won't work:</p>
<pre><code class="language-sh"># Does NOT work
find . \(-name '*.c*' -o -name '*.cpp' -o -name '*.h'\) 
</code></pre>
<h2 id="find-text-in-all-c-files"><a class="header" href="#find-text-in-all-c-files">Find text in all C files</a></h2>
<hr />
<pre><code class="language-sh">find . -name '*.c*' -exec grep 'text' {} +
</code></pre>
<p>For a more detalied output, that will include:</p>
<ul>
<li><code>-H</code> the path of the file</li>
<li><code>-n</code> line number</li>
<li><code>-color</code> colors matched REGEXs</li>
</ul>
<pre><code class="language-sh">find . -name '*.c*' -exec grep -H -n --color 'text' {} +
</code></pre>
<h2 id="find-replace-text-in-all-c-files"><a class="header" href="#find-replace-text-in-all-c-files">Find-Replace text in all C files</a></h2>
<hr />
<pre><code class="language-sh">find . -name '*.c*' -exec sed -i 's/old text/new text/g' {} +
</code></pre>
<h2 id="rename-all-c-files-to-cpp"><a class="header" href="#rename-all-c-files-to-cpp">Rename all C files to CPP</a></h2>
<hr />
<pre><code class="language-sh">find . -type f -name "*.c" -exec bash -c 'mv "$0" "${0%.c}.cpp"' {} \;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jq-json-querry"><a class="header" href="#jq-json-querry"><code>jq</code> (JSON Querry)</a></h1>
<h2 id="tldr-18"><a class="header" href="#tldr-18"><strong>TL;DR</strong></a></h2>
<hr />
<p>A JSON processor that uses a domain-specific language (DSL).</p>
<p>More information: <a href="https://jqlang.github.io/jq/manual/">https://jqlang.github.io/jq/manual/</a>.</p>
<pre><code class="language-sh"># Execute a specific expression only using the jq binary (print a colored and formatted JSON output):
jq '.' /path/to/file.json

# Execute a specific script:
cat path/to/file.json | jq --from-file path/to/script.jq

# Pass specific arguments:
cat path/to/file.json | jq --arg "name1" "value1" --arg "name2" "value2" ... '. + $ARGS.named'

# Create new JSON object via old JSON objects from multiple files:
cat path/to/multiple_json_file_*.json | jq '{newKey1: .key1, newKey2: .key2.nestedKey, ...}'

# Print specific array items:
cat path/to/file.json | jq '.[index1], .[index2], ...'

# Print all array/object values:
cat path/to/file.json | jq '.[]'

# Print objects with 2-condition filter in array:
cat path/to/file.json | jq '.[] | select((.key1=="value1") and .key2=="value2")'

# Add/remove specific keys:
cat path/to/file.json | jq '. +|# {"key1": "value1", "key2": "value2", ...}'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="packages"><a class="header" href="#packages">Packages</a></h1>
<hr />
<ul>
<li><a href="content/System-Administrator/./Packages/nala.html">nala</a></li>
<li><a href="content/System-Administrator/./Packages/apt.html">apt</a></li>
<li><a href="content/System-Administrator/./Packages/dpkg.html">dpkg</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nala"><a class="header" href="#nala"><code>nala</code></a></h1>
<h2 id="tldr-19"><a class="header" href="#tldr-19"><strong>TL;DR</strong></a></h2>
<hr />
<p>Package management utility with better formatting.</p>
<p>Front-end for the python-apt API.</p>
<p>More information: <a href="https://gitlab.com/volian/nala">https://gitlab.com/volian/nala</a>.</p>
<pre><code class="language-sh"># Install a package, or update it to the latest available version:
sudo nala install package

# Remove a package:
sudo nala remove package

# Remove a package and its configuration files:
nala purge package

# Search package names and descriptions using a word, regex (default) or glob:
nala search "pattern"

# Update the list of available packages and upgrade the system:
sudo nala upgrade

# Remove all unused packages and dependencies from your system:
sudo nala autoremove

# Fetch fast mirrors to improve download speeds:
sudo nala fetch

# Display the history of all transactions:
nala history
</code></pre>
<h2 id="stop-using-apt"><a class="header" href="#stop-using-apt">Stop using APT</a></h2>
<hr />
<iframe width=600px height="350px" aspect-ratio=16/9 src="https://www.youtube.com/embed/oroSkR4Nn_w" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<h2 id="install-nala"><a class="header" href="#install-nala">Install nala</a></h2>
<hr />
<blockquote>
<p>Check out this link: <a href="https://gitlab.com/volian/nala/-/wikis/Installation">https://gitlab.com/volian/nala/-/wikis/Installation</a>.</p>
</blockquote>
<p>Nala is officially in the testing and sid repos.</p>
<pre><code class="language-sh">sudo apt install nala
</code></pre>
<p>The following command will setup the repository and install Nala for you:</p>
<pre><code class="language-sh">curl https://gitlab.com/volian/volian-archive/-/raw/main/install-nala.sh | bash
</code></pre>
<blockquote>
<p>note: Ubuntu 20.04, 22.04 and Debian Bullseye this script may fail. If it does run</p>
</blockquote>
<pre><code class="language-sh">sudo apt install -t nala nala
</code></pre>
<h2 id="results-for-nala"><a class="header" href="#results-for-nala">Results for <code>nala</code></a></h2>
<hr />
<p>Fetch fast mirrors to improve download speed</p>
<pre><code class="language-sh">$ sudo nala fetch
</code></pre>
<p><strong>Result</strong>:</p>
<br>
<img alt="img" src="content/System-Administrator/Packages/Images/nala/nala_fetch (in progress).png" height=auto width=auto>
<img alt="img" src="content/System-Administrator/Packages/Images/nala/nala_fetch (completed).png" height=auto width=auto>
<br>
<pre><code class="language-sh">$ sudo nala install -y curl wget gcc
</code></pre>
<p><strong>Result</strong>:</p>
<br>
<img alt="img" src="content/System-Administrator/Packages/Images/nala/nala_install_curl_wget_gcc%20(in%20progress).png" height=auto width=auto>
<img alt="img" src="content/System-Administrator/Packages/Images/nala/nala_install_curl_wget_gcc%20(completed).png" height=auto width=auto>
<br>
<p>Much better! Right?!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apt"><a class="header" href="#apt"><code>apt</code></a></h1>
<h2 id="tldr-20"><a class="header" href="#tldr-20"><strong>TL;DR</strong></a></h2>
<hr />
<p>Package management utility for Debian based distributions.</p>
<p>Recommended replacement for apt-get when used interactively in Ubuntu versions 16.04 and later.</p>
<p>For equivalent commands in other package managers, see <a href="https://wiki.archlinux.org/title/Pacman/Rosetta">https://wiki.archlinux.org/title/Pacman/Rosetta</a>.</p>
<p>More information: <a href="https://manned.org/apt.8">https://manned.org/apt.8</a>.</p>
<pre><code class="language-sh"># Update the list of available packages and versions (it's recommended to run this before other apt commands):
sudo apt update

# Search for a given package:
apt search package

# Show information for a package:
apt show package

# Install a package, or update it to the latest available version:
sudo apt install package

# Remove a package (using purge instead also removes its configuration files):
sudo apt remove package

# Upgrade all installed packages to their newest available versions:
sudo apt upgrade

# List all packages:
apt list

# List installed packages:
apt list --installed
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dpkg"><a class="header" href="#dpkg"><code>dpkg</code></a></h1>
<h2 id="tldr-21"><a class="header" href="#tldr-21"><strong>TL;DR</strong></a></h2>
<hr />
<p>Debian package manager.</p>
<p>Some subcommands such as deb have their own usage documentation.</p>
<p>For equivalent commands in other package managers, see <a href="https://wiki.archlinux.org/title/Pacman/Rosetta">https://wiki.archlinux.org/title/Pacman/Rosetta</a>.</p>
<p>More information: <a href="https://manned.org/dpkg">https://manned.org/dpkg</a>.</p>
<pre><code class="language-sh"># Install a package:
dpkg -i path/to/file.deb

# Remove a package:
dpkg -r package

# List installed packages:
dpkg -l pattern

# List a package's contents:
dpkg -L package

# List contents of a local package file:
dpkg -c path/to/file.deb

# Find out which package owns a file:
dpkg -S path/to/file

# Purge an installed or already removed package, including configuration:
dpkg -P package
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="users"><a class="header" href="#users">Users</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="useradd"><a class="header" href="#useradd"><code>useradd</code></a></h1>
<h2 id="tldr-22"><a class="header" href="#tldr-22"><strong>TL;DR</strong></a></h2>
<hr />
<p>Create a new user.</p>
<p>More information: https://manned.org/useradd.</p>
<pre><code class="language-sh"># Create a new user:
sudo useradd username

# Create a new user with the specified user ID:
sudo useradd -u|--uid id username

# Create a new user with the specified shell:
sudo useradd -s|--shell path/to/shell username

# Create a new user belonging to additional groups (mind the lack of whitespace):
sudo useradd -G|--groups group1,group2,... username

# Create a new user with the default home directory:
sudo useradd -m|--create-home username

# Create a new user with the home directory filled by template directory files:
sudo useradd -k|--skel path/to/template_directory -m|--create-home username

# Create a new system user without the home directory:
sudo useradd -r|--system username
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adduser"><a class="header" href="#adduser"><code>adduser</code></a></h1>
<h2 id="tldr-23"><a class="header" href="#tldr-23"><strong>TL;DR</strong></a></h2>
<hr />
<p>User addition utility.</p>
<p>More information: <a href="https://manned.org/adduser">https://manned.org/adduser</a>.</p>
<pre><code class="language-sh">- Create a new user with a default home directory and prompt the user to set a password:
adduser username

- Create a new user without a home directory:
adduser --no-create-home username

- Create a new user with a home directory at the specified path:
adduser --home path/to/home username

- Create a new user with the specified shell set as the login shell:
adduser --shell path/to/shell username

- Create a new user belonging to the specified group:
adduser --ingroup group username
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="userdel"><a class="header" href="#userdel"><code>userdel</code></a></h1>
<h2 id="tldr-24"><a class="header" href="#tldr-24"><strong>TL;DR</strong></a></h2>
<hr />
<p>Remove a user account or remove a user from a group.</p>
<p>More information: <a href="https://manned.org/userdel">https://manned.org/userdel</a>.</p>
<pre><code class="language-sh"># Remove a user:
sudo userdel username

# Remove a user in other root directory:
sudo userdel -R|--root path/to/other/root username

# Remove a user along with the home directory and mail spool:
sudo userdel -r|--remove username
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chsh"><a class="header" href="#chsh"><code>chsh</code></a></h1>
<h2 id="tldr-25"><a class="header" href="#tldr-25"><strong>TL;DR</strong></a></h2>
<hr />
<p>Change user's login shell.</p>
<p>See platform-specific pages for more options.</p>
<p>More information: <a href="https://manned.org/chsh">https://manned.org/chsh</a>.</p>
<pre><code class="language-sh"># Set a specific login shell for the current user interactively:
chsh

# Set a specific login [s]hell for the current user:
chsh -s path/to/shell

# Set a login [s]hell for a specific user:
chsh -s path/to/shell username
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="passwd"><a class="header" href="#passwd"><code>passwd</code></a></h1>
<h2 id="tldr-26"><a class="header" href="#tldr-26"><strong>TL;DR</strong></a></h2>
<hr />
<p>Change a user's password.</p>
<p>More information: <a href="https://manned.org/passwd">https://manned.org/passwd</a>.</p>
<pre><code class="language-sh"># Change the password of the current user interactively:
passwd

# Change the password of a specific user:
passwd username

# Get the current status of the user:
passwd -S|--status

# Make the password of the account blank (it will set the named account passwordless):
passwd -d|--delete
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="change-users-name"><a class="header" href="#change-users-name">Change user's name</a></h1>
<p>TODO</p>
<p>idk</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="change-users-passwords"><a class="header" href="#change-users-passwords">Change user's passwords</a></h1>
<pre><code class="language-sh">passwd &lt;username&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="change-users-default-shell"><a class="header" href="#change-users-default-shell">Change user's default shell</a></h1>
<h2 id="step-1-list-available-shells"><a class="header" href="#step-1-list-available-shells">STEP 1: List available shells</a></h2>
<hr />
<pre><code class="language-sh">$ cat /etc/shells
# /etc/shells: valid login shells
/bin/sh
/usr/bin/sh
/bin/bash
/usr/bin/bash
/bin/rbash
/usr/bin/rbash
/usr/bin/dash
/bin/zsh
/usr/bin/zsh
/usr/bin/tmux
</code></pre>
<h2 id="step-2-actually-change-default-shell"><a class="header" href="#step-2-actually-change-default-shell">STEP 2: Actually change default shell</a></h2>
<hr />
<ul>
<li>Method 1: using <code>usermod</code> utility</li>
</ul>
<pre><code class="language-sh">sudo usermod --shell /bin/bash &lt;username&gt;
</code></pre>
<ul>
<li>Method 2: using <code>chsh</code> utility
<ul>
<li>
<blockquote>
<p>This method also modifies the <code>/etc/passwd</code> file 😊</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<pre><code class="language-sh">sudo chsh -s /bin/bash &lt;username&gt;
</code></pre>
<ul>
<li>Method 2: modify the <code>/etc/passwd</code> file (but be careful)</li>
</ul>
<pre><code class="language-sh">sudo nano -l /etc/passwd
</code></pre>
<h2 id="step-3-logout"><a class="header" href="#step-3-logout">STEP 3: <strong>logout</strong></a></h2>
<hr />
<blockquote>
<p><strong>logout</strong>/<strong>exit</strong> the shell, and next time you open a new shell,
you should see the changes applied.</p>
</blockquote>
<pre><code class="language-sh">logout
</code></pre>
<pre><code class="language-sh">exit
</code></pre>
<h2 id="step-4-verify"><a class="header" href="#step-4-verify">STEP 4: Verify</a></h2>
<hr />
<p>Run the following commands:</p>
<pre><code class="language-sh">$ echo $SHELL
/bin/zsh
</code></pre>
<p>or:</p>
<pre><code class="language-sh">$ grep "$USER" /etc/passwd
student:x:1000:1000:student:/home/student:/bin/zsh
</code></pre>
<p>or:</p>
<pre><code class="language-sh">$ ps -p $$
    PID TTY          TIME CMD
  16256 pts/0    00:00:00 zsh
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-docker"><a class="header" href="#installing-docker">Installing Docker</a></h1>
<h2 id="docker-engine"><a class="header" href="#docker-engine">Docker Engine</a></h2>
<hr />
<ul>
<li>It's the core container runtime that allows you to build, run, and manage containers.</li>
<li>Includes the Docker daemon, REST API, and CLI tools.</li>
<li>Runs on Linux by default, but can also be used on Windows and macOS (via WSL2 or a VM).</li>
<li>Typically used on servers or production environments where you don’t need a graphical interface.</li>
</ul>
<h2 id="docker-desktop"><a class="header" href="#docker-desktop">Docker Desktop</a></h2>
<hr />
<ul>
<li>A full package that includes Docker Engine along with a GUI and other tools.</li>
<li>Available for Windows and macOS (uses a lightweight VM to run Docker Engine).</li>
<li>Includes additional features like Kubernetes integration, Docker Compose, and Volume Management UI.</li>
<li>Primarily designed for developers working on their local machines.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation-on-ubuntu"><a class="header" href="#installation-on-ubuntu">Installation on Ubuntu</a></h1>
<h2 id="installing-docker-desktop"><a class="header" href="#installing-docker-desktop">Installing Docker Desktop</a></h2>
<hr />
<blockquote>
<p>Checkout this link: <a href="https://docs.docker.com/desktop/setup/install/linux/ubuntu/">https://docs.docker.com/desktop/setup/install/linux/ubuntu/</a>.</p>
</blockquote>
<p>Download the latest <a href="https://desktop.docker.com/linux/main/amd64/docker-desktop-amd64.deb?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=docs-driven-download-linux-amd64">DEB package</a>.</p>
<pre><code class="language-sh">sudo apt install gnome-terminal
sudo apt-get update
sudo apt-get install ./docker-desktop-amd64.deb
</code></pre>
<h2 id="installing-just-docker-engine"><a class="header" href="#installing-just-docker-engine">Installing just Docker Engine</a></h2>
<hr />
<blockquote>
<p>Checkout this link: <a href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a>.</p>
</blockquote>
<pre><code class="language-sh"># Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release &amp;&amp; echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt-get update

sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
